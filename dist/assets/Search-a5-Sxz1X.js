import{q as m,l as y,s as P,o as l,w as f,k as h,e as g,m as j,n as S,b as k,a as q,r as A,j as r}from"./index-FIlqUQy7.js";import{u as N,a as v}from"./useProductsQuery-7DOrtXK_.js";import{P as B}from"./ProductList-e5Ca9sI_.js";import{M as L}from"./MetaTag-VgbHpOZK.js";import"./useQuery-cNdFQeOr.js";import"./suspense-eH29BjpB.js";import"./ProductContainer-yYnW6JCc.js";import"./utils-e7QYg_mL.js";import"./button-zmJg5Lpq.js";import"./createLucideIcon-660fMRwt.js";import"./chevron-right-p5SKVCdk.js";import"./priceToString-jyYOkqXM.js";import"./getImageUrl-OqKMeRG-.js";async function b(s,e,t,o,i){console.log("keyword",s),console.log("orderField",t),console.log("orderDirection",o);let a;return i?a=m(h(g,"products"),f("keyword","array-contains",s.toLowerCase()),l(t,o),P(i),y(e)):a=m(h(g,"products"),f("keyword","array-contains",s.toLowerCase()),l(t,o),y(e)),(await j(a)).docs.map(d=>S(d.data()))}const X=()=>{const[s]=k(),e=s.get("keyword"),t=s.get("sortby"),o=q(),[i,a]=N(),{products:n,isLoading:d,hasNextPage:p,fetchNextPage:u}=v({rowsPerPage:8,qKey:[e,t||"createdAt"],queryFunc:(c,x)=>b(e,x,t==="price"?"productPrice":"createdAt",t==="price"?"asc":"desc",c),sortBy:"productName"});A.useEffect(()=>{a&&p&&u()},[a,p,u]);const w=c=>{t===c||!t&&c==="createdAt"||o(c==="createdAt"?`/product/search?keyword=${e}&sortby=createdAt`:`/product/search?keyword=${e}&sortby=price`)};return r.jsxs(r.Fragment,{children:[r.jsx(L,{title:`${e} - XSO 검색`}),r.jsxs("div",{className:"py-14",children:[r.jsx("h1",{className:"h1 mb-6",children:e}),!d&&n&&r.jsx(B,{products:n,onClickFilterItem:w,curSortBy:t==="price"?"price":"createdAt"}),r.jsx("div",{ref:i})]})]})};export{X as default};
