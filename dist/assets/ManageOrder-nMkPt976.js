import{k as Y,q as Z,o as ee,w as re,m as te,c as oe,r as p,R as c,j as e,L as G,u as se,_ as ae,g as ne}from"./index-B_PGsR37.js";import{a as ce}from"./index-ukAsKlpg.js";import{f as le,o as de,a as E}from"./orderStatusToString-RMqDhgDU.js";import ie from"./getImageUrl-mfxCVYYg.js";import ue from"./getUser-HAuIL_Op.js";import{M as fe}from"./MyPageLayout-h4gyn3Mm.js";import{c as pe,B as me}from"./button-h62HKO48.js";import{_ as f,c as P}from"./utils-dWbl7AoH.js";import{a as w,c as ge,$ as xe}from"./index-ILLqcFKf.js";import{$ as N}from"./index-Ow67C2FL.js";import{$ as S,a as ve,b as $e}from"./index-ZObnYLK8.js";import{a as be}from"./index-mCgTRyut.js";import{S as x}from"./order-zBTb25aT.js";import{M as he}from"./MetaTag-ef0lWzjX.js";import{M as j}from"./Modal-JqBpjloQ.js";import{u as y}from"./useQuery-LGw8-puI.js";import"./iconBase-pe5NBUnU.js";import"./utils-sVZp_qSd.js";import"./suspense-JhA63HVw.js";async function je(r){console.log("sellerId",r);const o=Y(oe,"orders"),n=Z(o,re("sellerId","==",r),ee("createdAt","desc"));return(await te(n)).docs.map(a=>le(a.data()))}const V=p.forwardRef((r,o)=>{const{pressed:n,defaultPressed:s=!1,onPressedChange:a,...t}=r,[l=!1,d]=w({prop:n,onChange:a,defaultProp:s});return p.createElement(N.button,f({type:"button","aria-pressed":l,"data-state":l?"on":"off","data-disabled":r.disabled?"":void 0},t,{ref:o,onClick:ge(r.onClick,()=>{r.disabled||d(!l)})}))}),M=V,_="ToggleGroup",[q,We]=xe(_,[S]),k=S(),ye=c.forwardRef((r,o)=>{const{type:n,...s}=r;if(n==="single"){const a=s;return c.createElement(_e,f({},a,{ref:o}))}if(n==="multiple"){const a=s;return c.createElement(Ce,f({},a,{ref:o}))}throw new Error(`Missing prop \`type\` expected on \`${_}\``)}),[R,D]=q(_),_e=c.forwardRef((r,o)=>{const{value:n,defaultValue:s,onValueChange:a=()=>{},...t}=r,[l,d]=w({prop:n,defaultProp:s,onChange:a});return c.createElement(R,{scope:r.__scopeToggleGroup,type:"single",value:l?[l]:[],onItemActivate:d,onItemDeactivate:c.useCallback(()=>d(""),[d])},c.createElement(F,f({},t,{ref:o})))}),Ce=c.forwardRef((r,o)=>{const{value:n,defaultValue:s,onValueChange:a=()=>{},...t}=r,[l=[],d]=w({prop:n,defaultProp:s,onChange:a}),i=c.useCallback(u=>d((m=[])=>[...m,u]),[d]),$=c.useCallback(u=>d((m=[])=>m.filter(h=>h!==u)),[d]);return c.createElement(R,{scope:r.__scopeToggleGroup,type:"multiple",value:l,onItemActivate:i,onItemDeactivate:$},c.createElement(F,f({},t,{ref:o})))}),[Ne,Te]=q(_),F=c.forwardRef((r,o)=>{const{__scopeToggleGroup:n,disabled:s=!1,rovingFocus:a=!0,orientation:t,dir:l,loop:d=!0,...i}=r,$=k(n),u=be(l),m={role:"group",dir:u,...i};return c.createElement(Ne,{scope:n,rovingFocus:a,disabled:s},a?c.createElement(ve,f({asChild:!0},$,{orientation:t,dir:u,loop:d}),c.createElement(N.div,f({},m,{ref:o}))):c.createElement(N.div,f({},m,{ref:o})))}),T="ToggleGroupItem",Ge=c.forwardRef((r,o)=>{const n=D(T,r.__scopeToggleGroup),s=Te(T,r.__scopeToggleGroup),a=k(r.__scopeToggleGroup),t=n.value.includes(r.value),l=s.disabled||r.disabled,d={...r,pressed:t,disabled:l},i=c.useRef(null);return s.rovingFocus?c.createElement($e,f({asChild:!0},a,{focusable:!l,active:t,ref:i}),c.createElement(I,f({},d,{ref:o}))):c.createElement(I,f({},d,{ref:o}))}),I=c.forwardRef((r,o)=>{const{__scopeToggleGroup:n,value:s,...a}=r,t=D(T,n),l={role:"radio","aria-checked":r.pressed,"aria-pressed":void 0},d=t.type==="single"?l:void 0;return c.createElement(V,f({},d,a,{ref:o,onPressedChange:i=>{i?t.onItemActivate(s):t.onItemDeactivate(s)}}))}),O=ye,A=Ge,L=pe("inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground",{variants:{variant:{default:"bg-transparent",outline:"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground"},size:{default:"h-10 px-3",sm:"h-9 px-2.5",lg:"h-11 px-5"}},defaultVariants:{variant:"default",size:"default"}}),Pe=p.forwardRef(({className:r,variant:o,size:n,...s},a)=>e.jsx(M,{ref:a,className:P(L({variant:o,size:n,className:r})),...s}));Pe.displayName=M.displayName;const B=p.createContext({size:"default",variant:"default"}),z=p.forwardRef(({className:r,variant:o,size:n,children:s,...a},t)=>e.jsx(O,{ref:t,className:P("flex items-center justify-center gap-1",r),...a,children:e.jsx(B.Provider,{value:{variant:o,size:n},children:s})}));z.displayName=O.displayName;const v=p.forwardRef(({className:r,children:o,variant:n,size:s,...a},t)=>{const l=p.useContext(B);return e.jsx(A,{ref:t,className:P(L({variant:l.variant||n,size:l.size||s}),r),...a,children:o})});v.displayName=A.displayName;const we=c.memo(({filename:r})=>{const{data:o,isLoading:n,isError:s,error:a}=y({queryKey:["productImage",r],queryFn:({queryKey:t})=>ie(t[1]),staleTime:1/0});return n?e.jsx(G,{}):s?(console.log(a),e.jsx("div",{className:"w-full h-full bg-gray-100"})):e.jsx("img",{src:o,className:"w-full h-full object-cover"})}),Ee=c.memo(({orderId:r,status:o,productId:n,quantity:s,buyerId:a,date:t})=>{const[l,d]=p.useState(!1),[i,$]=p.useState(o),{data:u,isLoading:m,isError:h,error:K}=y({queryKey:["product",n],queryFn:({queryKey:g})=>ne(g[1]),staleTime:1/0}),{data:b,isError:U,error:Q}=y({queryKey:["user",a],queryFn:({queryKey:g})=>ue(g[1]),staleTime:3e5}),H=()=>{C()},C=()=>{d(!l)};if(m)return e.jsx(G,{});if(!u||h)return console.log("query - product",K),e.jsx("p",{children:"주문 상품을 불러오지 못했습니다."});U&&console.log("query - buyer",Q);const J=async()=>{if(console.log(i),window.confirm("주문 상태를 정말 변경하시겠습니까?")){const{default:W}=await ae(()=>import("./updateOrderStatus-j7Lz_1Rp.js"),__vite__mapDeps([0,1,2]));W(r,i).then(()=>{window.alert("주문 상태를 변경했습니다."),C()}).catch(X=>{console.log(X),window.alert("주문 상태를 변경하지 못했습니다.")})}};return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center text-sm p-4 cursor-pointer",onClick:H,children:[e.jsx("div",{className:"min-w-max",children:e.jsx("p",{children:de(o,!0)})}),e.jsxs("div",{className:"flex items-center mx-4 w-full",children:[e.jsx("div",{className:"w-24 h-24 min-w-24 mr-4",children:e.jsx(we,{filename:u.productImage[0]})}),e.jsxs("div",{children:[e.jsx("p",{children:u.productName}),e.jsx("p",{children:`수량: ${s}개`})]})]}),e.jsx("div",{className:"ml-4",children:b&&e.jsx("p",{children:b.nickname})}),e.jsx("div",{className:"ml-4",children:e.jsx("p",{children:E(t.toDate())})})]}),l&&u&&!h&&e.jsx("div",{className:"ModalOutside",children:e.jsxs(j,{children:[e.jsx(j.Header,{title:"주문 상태 변경",children:e.jsx(j.Close,{onClose:C,children:e.jsx(ce,{})})}),e.jsxs(j.Body,{children:[e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"mb-2",children:"다음 주문 건의 주문 상태를 변경해주세요."}),e.jsx("p",{children:`주문일: ${E(t.toDate())}`}),e.jsx("p",{children:`구매자: ${b==null?void 0:b.nickname}`}),e.jsx("p",{children:`상품명: ${u.productName}`})]}),e.jsxs(z,{className:"my-8",variant:"outline",type:"single",value:i,onValueChange:g=>$(x[g]),children:[e.jsx(v,{value:x.order_completed,children:"구매 확인"}),e.jsx(v,{value:x.waiting_deliver,children:"발송 대기"}),e.jsx(v,{value:x.deliver_started,children:"발송 시작"}),e.jsx(v,{value:x.deliver_completed,children:"판매 완료"}),e.jsx(v,{value:x.order_canceled,children:"주문 취소"})]}),e.jsx("div",{className:"w-full flex justify-center",children:e.jsx(me,{disabled:!i,onClick:J,children:"등록"})})]})]})})]})}),Xe=()=>{const r=se(),{data:o,isLoading:n,isError:s,error:a}=y({queryKey:["orders",r.id],queryFn:({queryKey:t})=>je(t[1]),staleTime:2e3});return s&&console.log(a),e.jsxs(e.Fragment,{children:[e.jsx(he,{}),e.jsxs(fe,{children:[e.jsx("h1",{className:"h1 mb-4",children:"판매 기록 관리"}),e.jsx("p",{children:"각 항목을 클릭하여 상태를 변경하세요."}),e.jsxs("div",{className:"mt-12",children:[e.jsxs("div",{className:"flex text-sm p-4 border-b border-black",children:[e.jsx("p",{className:"w-[5rem] text-center mr-4",children:"상태"}),e.jsx("p",{className:"w-full text-center",children:"상품"}),e.jsx("p",{className:"ml-4 min-w-max",children:"구매자"}),e.jsx("p",{className:"ml-4 w-[6rem] text-center",children:"주문일"})]}),n?e.jsx(G,{}):s?e.jsx("p",{children:"판매 기록을 불러오지 못했습니다."}):e.jsx("ul",{children:o.map((t,l)=>e.jsx("li",{className:"*:mt-4",children:e.jsx(Ee,{orderId:t.id,status:t.status,productId:t.productId,quantity:t.productQuantity,buyerId:t.buyerId,date:t.createdAt})},`order_${l}`))})]})]})]})};export{Xe as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/updateOrderStatus-j7Lz_1Rp.js","assets/index-B_PGsR37.js","assets/index-2jMTQVvy.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
