import{q as m,l as y,s as j,o as l,w as g,m as f,e as h,n as S,p as q,b as A,a as N,r as k,j as r,L}from"./index-Vq1JXboX.js";import{u as v,a as B}from"./useProductsQuery-fC5KW7wc.js";import{P as b}from"./ProductList-NOLEquVK.js";import{M as C}from"./MetaTag-ZlBfLCmT.js";import"./useBaseQuery-zMsKL3zC.js";import"./utils-bemYdGE3.js";import"./suspense-9ho99RMx.js";import"./ProductContainer-ypXsEUkS.js";import"./utils-Anq8py01.js";import"./button-DbWM39RQ.js";import"./createLucideIcon-teTjWQfU.js";import"./priceToString-jyYOkqXM.js";async function E(s,e,t,o,i){console.log("keyword",s),console.log("orderField",t),console.log("orderDirection",o);let a;return i?a=m(f(h,"products"),g("keyword","array-contains",s.toLowerCase()),l(t,o),j(i),y(e)):a=m(f(h,"products"),g("keyword","array-contains",s.toLowerCase()),l(t,o),y(e)),(await S(a)).docs.map(d=>q(d.data()))}const z=()=>{const[s]=A(),e=s.get("keyword"),t=s.get("sortby"),o=N(),[i,a]=v(),{products:n,isLoading:d,hasNextPage:p,fetchNextPage:u,isFetchingNextPage:w}=B({rowsPerPage:8,qKey:[e,t||"createdAt"],queryFunc:(c,P)=>E(e,P,t==="price"?"productPrice":"createdAt",t==="price"?"asc":"desc",c),sortBy:"productName"});k.useEffect(()=>{a&&p&&u()},[a,p,u]);const x=c=>{t===c||!t&&c==="createdAt"||o(c==="createdAt"?`/product/search?keyword=${e}&sortby=createdAt`:`/product/search?keyword=${e}&sortby=price`)};return r.jsxs(r.Fragment,{children:[r.jsx(C,{title:`${e} - XSO 검색`}),r.jsxs("div",{className:"py-14",children:[r.jsx("h1",{className:"h1 mb-6",children:e}),!d&&n&&r.jsx(b,{products:n,onClickFilterItem:x,curSortBy:t==="price"?"price":"createdAt"}),w?r.jsx(L,{}):r.jsx("div",{ref:i})]})]})};export{z as default};
