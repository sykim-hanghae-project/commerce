import{k as I,q as C,o as k,w as E,m as M,c as S,R as L,j as e,L as j,u as T,a as B,g as O,_ as P}from"./index-IIH_jOnl.js";import{B as R}from"./index-RB1m6lhY.js";import{M as F}from"./MyPageLayout-euvnV1_h.js";import{f as A,a as K,o as $}from"./orderStatusToString-RMqDhgDU.js";import Q from"./getImageUrl-c3cqJjiv.js";import U from"./getUser-y5b9Z8Wy.js";import{S as d}from"./order-zBTb25aT.js";import{D as V,a as W,b as z,c as w}from"./dropdown-menu-Wi2c2-ze.js";import{M as G}from"./MetaTag-AMYNbank.js";import{u as m}from"./useQuery-htsuB4eh.js";import"./iconBase-YMfTHyJN.js";import"./utils-a2TjXGlz.js";import"./index-rkLLBaAt.js";import"./index-4gCfSGuH.js";import"./index-9htsbkNG.js";import"./Combination-dzijrcJl.js";import"./check-21oTJtZj.js";import"./index--4z9oSKp.js";import"./createLucideIcon-plAKe6Hx.js";import"./index-cqbw5j9H.js";import"./index-cvKtFmQT.js";import"./chevron-right-DmzFeNoH.js";import"./circle-IQUCaWrg.js";import"./utils-5WYmz0B3.js";import"./suspense-xKbUm0tH.js";async function H(t){const a=I(S,"orders"),o=C(a,E("buyerId","==",t),k("createdAt","desc"));return(await M(o)).docs.map(i=>A(i.data()))}const J=L.memo(({filename:t})=>{const{data:a,isLoading:o,isError:c,error:i}=m({queryKey:["productImage",t],queryFn:({queryKey:r})=>Q(r[1]),staleTime:1/0});return o?e.jsx(j,{}):c?(console.log(i),e.jsx("div",{className:"w-full h-full bg-gray-100"})):e.jsx("img",{src:a,className:"w-full h-full object-cover"})}),X=({orderId:t,date:a,productId:o,quantity:c,sellerId:i,status:r})=>{const u=B(),{data:h,isError:y,error:N}=m({queryKey:["userNickname",i],queryFn:async({queryKey:s})=>{const n=await U(s[1]);return n?n.nickname:null}});y&&console.log(N);const{data:l,isLoading:g,isError:p,error:v}=m({queryKey:["product",o],queryFn:async({queryKey:s})=>{const n=await O(s[1]);if(n)return n}});p&&console.log(v);const _=()=>{},b=async()=>{if(window.confirm("정말 주문을 취소하시겠습니까?")){const{default:n}=await P(()=>import("./updateOrderStatus-1fyKQYmp.js"),__vite__mapDeps([0,1,2]));await n(t,d.order_canceled).then(()=>{window.alert("주문을 취소하였습니다."),window.location.reload()}).catch(D=>{console.log(D),window.alert("주문를 취소하지 못했습니다.")})}};function x(s){return s!==d.deliver_completed&&s!==d.order_canceled}function f(s){return s==d.deliver_completed}const q=()=>{u(`/product/${l==null?void 0:l.id}`)};return e.jsxs("div",{className:"flex items-center p-4 ",children:[e.jsx("div",{className:"mr-4 w-32 flex justify-center ",children:e.jsx("p",{children:K(a.toDate())})}),e.jsx("div",{className:"w-24 h-24 min-w-24 mr-4",children:g?e.jsx(j,{}):p?e.jsx("div",{className:"w-full h-full bg-gray-100"}):e.jsx(J,{filename:l.productImage[0]})}),e.jsxs("div",{className:"w-full",children:[g?e.jsx("p",{}):p?e.jsx("p",{}):e.jsx("button",{className:"text-ellipsis line-clamp-1 text-sm",onClick:q,children:l.productName}),e.jsx("p",{className:"text-sm",children:`수량: ${c}`})]}),e.jsx("div",{children:h&&e.jsx("p",{className:"text-ellipsis line-clamp-1 text-sm",children:h})}),e.jsx("div",{className:"ml-4",children:e.jsx("p",{className:"text-sm min-w-max",children:$(r,!1)})}),e.jsx("div",{className:"ml-4 ",children:e.jsxs(V,{children:[e.jsx(W,{asChild:!0,children:e.jsx("button",{className:`button ${!(x(r)||f(r))&&"opacity-0"}`,disabled:!(x(r)||f(r)),children:e.jsx(R,{})})}),e.jsxs(z,{children:[f(r)&&e.jsx(w,{onClick:_,children:"리뷰 작성"}),x(r)&&e.jsx(w,{onClick:b,children:"주문 취소"})]})]})})]})},_e=()=>{const t=T(),{data:a,isLoading:o,isError:c,error:i}=m({queryKey:["orders",t.id],queryFn:({queryKey:r})=>H(r[1])});return o?e.jsx(j,{}):c?(console.log(i),e.jsx("p",{children:"주문 내역을 불러오지 못했습니다."})):e.jsxs(e.Fragment,{children:[e.jsx(G,{}),e.jsxs(F,{children:[e.jsx("h1",{className:"h1 mb-12",children:"주문 내역"}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm p-4 pr-12 flex border-b border-black",children:[e.jsx("p",{className:"w-32 text-center",children:"주문일"}),e.jsx("p",{className:"w-full text-center",children:"상품"}),e.jsx("p",{className:"text-center min-w-max mr-4",children:"판매자"}),e.jsx("p",{className:"w-20 text-center min-w-max",children:"주문 상태"})]}),e.jsx("ul",{className:"mt-4",children:a.map((r,u)=>e.jsx("li",{className:"*:mt-4",children:e.jsx(X,{orderId:r.id,date:r.createdAt,productId:r.productId,quantity:r.productQuantity,sellerId:r.sellerId,status:r.status})},`order_${u}`))})]})]})]})};export{_e as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/updateOrderStatus-1fyKQYmp.js","assets/index-IIH_jOnl.js","assets/index-2jMTQVvy.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
