import{l as w,m as P,n as I,p as N,r as m,a as S,h as E,b as q,j as o,L as p}from"./index-DyzY6ZJS.js";import{M as L}from"./MyPageLayout-GYR7_71g.js";import{P as M,u as f}from"./ProductForm-BzQTxW_0.js";import{d as F}from"./deleteImage-6x84cI3I.js";import{u as Q}from"./updateProduct-8felqnc4.js";import{M as B}from"./MetaTag-qCC6KGd0.js";import"./select-hN8_c95W.js";import"./index-N5PwOM_v.js";import"./check-jMnHZxu6.js";import"./index-vVzCxcJx.js";import"./createLucideIcon-SSY--W-o.js";import"./index-Ld7vI764.js";import"./input-Bnpch_CL.js";async function C(s){const c=w(I,`images/${s}`);return await P(c)}const U=()=>{const[s]=N(),[c,u]=m.useState(!1),[d,l]=m.useState(),{data:e,isLoading:g,isError:y,error:b}=S({queryKey:["prevProduct",s.get("product")],queryFn:({queryKey:t})=>E(t[1]),staleTime:1/0}),h=q();if(m.useEffect(()=>{e&&l(e)},[e]),g)return o.jsx(p,{});if(y)return console.log(b),o.jsx("p",{children:"오류가 발생했습니다."});async function x(t){console.log(t),u(!0);try{const a=[];if(t.image){for(const r of t.image)if(r.isOriginal){const i=await C(r.filename);a.push(i)}}for(const r of d.productImage)await F(r);const n=[];for(const r of a){const i=await f(r);n.push(i)}if(t.image){for(const r of t.image)if(!r.isOriginal){const i=await f(r.file);n.push(i)}}const j={productName:t.name,productDescription:t.description,productImage:n,productCategory:t.category,productPrice:t.price,productQuantity:t.quantity};await Q(d.id,j),window.alert("상품을 성공적으로 수정하였습니다.")}catch(a){console.log(a),window.alert("상품 수정에 실패하였습니다.")}finally{h("/mypage")}}return o.jsxs(o.Fragment,{children:[o.jsx(B,{}),o.jsxs(L,{children:[o.jsx("h1",{className:"h1 mb-6",children:"상품 등록"}),o.jsx("p",{className:"mb-6",children:"상품의 정보를 입력해주세요."}),o.jsx("div",{className:"w-full",children:o.jsx(M,{onSubmit:x,defaultValues:e?{name:e.productName,description:e.productDescription,image:e.productImage,category:e.productCategory,price:e.productPrice,quantity:e.productQuantity}:void 0})}),c&&o.jsx("div",{className:"fixed top-0 left-0 w-[100vw] h-[100vh] flex justify-center items-center",children:o.jsx(p,{})})]})]})};export{U as default};
