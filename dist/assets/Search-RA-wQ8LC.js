import{q as m,l as y,s as P,o as l,w as f,k as h,c as g,m as j,n as S,b as k,a as q,r as A,j as e}from"./index-IIH_jOnl.js";import{u as N,a as v}from"./useProductsQuery-Iy9cFvMw.js";import{P as B}from"./ProductList-yJdzKoJG.js";import{M as L}from"./MetaTag-AMYNbank.js";import"./useQuery-htsuB4eh.js";import"./utils-5WYmz0B3.js";import"./suspense-xKbUm0tH.js";import"./ProductContainer-3k48im88.js";import"./utils-a2TjXGlz.js";import"./button-TCJ5KxuP.js";import"./createLucideIcon-plAKe6Hx.js";import"./chevron-right-DmzFeNoH.js";import"./priceToString-jyYOkqXM.js";import"./getImageUrl-c3cqJjiv.js";async function b(s,r,t,o,i){console.log("keyword",s),console.log("orderField",t),console.log("orderDirection",o);let a;return i?a=m(h(g,"products"),f("keyword","array-contains",s.toLowerCase()),l(t,o),P(i),y(r)):a=m(h(g,"products"),f("keyword","array-contains",s.toLowerCase()),l(t,o),y(r)),(await j(a)).docs.map(d=>S(d.data()))}const z=()=>{const[s]=k(),r=s.get("keyword"),t=s.get("sortby"),o=q(),[i,a]=N(),{products:n,isLoading:d,hasNextPage:p,fetchNextPage:u}=v({rowsPerPage:8,qKey:[r,t||"createdAt"],queryFunc:(c,x)=>b(r,x,t==="price"?"productPrice":"createdAt",t==="price"?"asc":"desc",c),sortBy:"productName"});A.useEffect(()=>{a&&p&&u()},[a,p,u]);const w=c=>{t===c||!t&&c==="createdAt"||o(c==="createdAt"?`/product/search?keyword=${r}&sortby=createdAt`:`/product/search?keyword=${r}&sortby=price`)};return e.jsxs(e.Fragment,{children:[e.jsx(L,{title:`${r} - XSO 검색`}),e.jsxs("div",{className:"py-14",children:[e.jsx("h1",{className:"h1 mb-6",children:r}),!d&&n&&e.jsx(B,{products:n,onClickFilterItem:w,curSortBy:t==="price"?"price":"createdAt"}),e.jsx("div",{ref:i})]})]})};export{z as default};
