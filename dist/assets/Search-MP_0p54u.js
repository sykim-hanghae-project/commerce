import{q as m,F as y,H as P,o as l,w as f,c as g,d as h,g as j,I as S,p as q,b as A,r as k,j as r}from"./index-DyzY6ZJS.js";import{u as N,a as v}from"./useProductsQuery-bUXNGjWx.js";import{P as B}from"./ProductList-IUjAd_P6.js";import{M as L}from"./MetaTag-qCC6KGd0.js";import"./ProductContainer-IMtkG0N5.js";import"./createLucideIcon-SSY--W-o.js";import"./chevron-right-8nadc7Ui.js";async function b(s,t,e,o,i){console.log("keyword",s),console.log("orderField",e),console.log("orderDirection",o);let a;return i?a=m(g(h,"products"),f("keyword","array-contains",s.toLowerCase()),l(e,o),P(i),y(t)):a=m(g(h,"products"),f("keyword","array-contains",s.toLowerCase()),l(e,o),y(t)),(await j(a)).docs.map(d=>S(d.data()))}const M=()=>{const[s]=q(),t=s.get("keyword"),e=s.get("sortby"),o=A(),[i,a]=N(),{products:n,isLoading:d,hasNextPage:u,fetchNextPage:p}=v({rowsPerPage:8,qKey:[t,e||"createdAt"],queryFunc:(c,x)=>b(t,x,e==="price"?"productPrice":"createdAt",e==="price"?"asc":"desc",c),sortBy:"productName"});k.useEffect(()=>{a&&u&&p()},[a,u,p]);const w=c=>{e===c||!e&&c==="createdAt"||o(c==="createdAt"?`/product/search?keyword=${t}&sortby=createdAt`:`/product/search?keyword=${t}&sortby=price`)};return r.jsxs(r.Fragment,{children:[r.jsx(L,{title:`${t} - XSO 검색`}),r.jsxs("div",{className:"py-14",children:[r.jsx("h1",{className:"h1 mb-6",children:t}),!d&&n&&r.jsx(B,{products:n,onClickFilterItem:w,curSortBy:e==="price"?"price":"createdAt"}),r.jsx("div",{ref:i})]})]})};export{M as default};
