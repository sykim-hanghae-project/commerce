import{l as P,m as j,n as I,p as N,r as m,a as S,h as E,b as q,j as r,L as p}from"./index-pc71vIdO.js";import{M as L}from"./MyPageLayout-OohYDt3i.js";import{P as Q,u as f}from"./ProductForm-_3avqxRj.js";import{d as B}from"./deleteImage-ynyOW7xS.js";import{u as C}from"./updateProduct-v1dJA9o7.js";import"./select-jrUSAbtJ.js";import"./index-94bxALhb.js";import"./check-24G-geZJ.js";import"./index-8MOaJxZt.js";import"./createLucideIcon-I6jI2dyF.js";import"./index-iWKDiuUA.js";import"./input-5GqNJ9oq.js";async function D(s){const c=P(I,`images/${s}`);return await j(c)}const H=()=>{const[s]=N(),[c,u]=m.useState(!1),[d,l]=m.useState(),{data:o,isLoading:g,isError:y,error:b}=S({queryKey:["prevProduct",s.get("product")],queryFn:({queryKey:t})=>E(t[1]),staleTime:1/0}),h=q();if(m.useEffect(()=>{o&&l(o)},[o]),g)return r.jsx(p,{});if(y)return console.log(b),r.jsx("p",{children:"오류가 발생했습니다."});async function x(t){console.log(t),u(!0);try{const a=[];if(t.image){for(const e of t.image)if(e.isOriginal){const i=await D(e.filename);a.push(i)}}for(const e of d.productImage)await B(e);const n=[];for(const e of a){const i=await f(e);n.push(i)}if(t.image){for(const e of t.image)if(!e.isOriginal){const i=await f(e.file);n.push(i)}}const w={productName:t.name,productDescription:t.description,productImage:n,productCategory:t.category,productPrice:t.price,productQuantity:t.quantity};await C(d.id,w),window.alert("상품을 성공적으로 수정하였습니다.")}catch(a){console.log(a),window.alert("상품 수정에 실패하였습니다.")}finally{h("/mypage")}}return r.jsxs(L,{children:[r.jsx("h1",{className:"h1 mb-6",children:"상품 등록"}),r.jsx("p",{className:"mb-6",children:"상품의 정보를 입력해주세요."}),r.jsx("div",{className:"w-full",children:r.jsx(Q,{onSubmit:x,defaultValues:o?{name:o.productName,description:o.productDescription,image:o.productImage,category:o.productCategory,price:o.productPrice,quantity:o.productQuantity}:void 0})}),c&&r.jsx("div",{className:"fixed top-0 left-0 w-[100vw] h-[100vh] flex justify-center items-center",children:r.jsx(p,{})})]})};export{H as default};
